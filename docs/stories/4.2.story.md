# Story 4.2: UX Refinements

## Status: Draft

## Story

**As a** Restaurant Staff user,  
**I want** keyboard shortcuts and improved interactions,  
**so that** I can work faster during busy service periods.

## Acceptance Criteria

1. Keyboard shortcuts available for common actions (documented in help modal)
2. `Ctrl+N` creates new order from Orders page
3. `Ctrl+R` refreshes current view
4. `Escape` closes modals and cancels edit forms
5. Menu items can be reordered within categories via drag-and-drop (Admin)
6. Dark mode toggle available for Kitchen Display (easier on eyes in low-light)
7. Bulk status update available for multiple orders (Kitchen)
8. Mobile responsiveness improved for Staff order entry on tablets

## Tasks / Subtasks

- [ ] **Task 1: Keyboard shortcuts infrastructure** (AC: 1, 2, 3, 4)
  - [ ] 1.1 Create `useKeyboardShortcuts` hook with configurable shortcuts
  - [ ] 1.2 Implement `Ctrl+N` for new order on OrdersPage
  - [ ] 1.3 Implement `Ctrl+R` for refresh across all pages
  - [ ] 1.4 Implement `Escape` to close modals globally
  - [ ] 1.5 Create keyboard shortcuts help modal (accessible via `?` key)
  - [ ] 1.6 Write tests for keyboard event handling

- [ ] **Task 2: Menu item drag-and-drop reordering** (AC: 5)
  - [ ] 2.1 Add `sortOrder` field to MenuItem model (migration)
  - [ ] 2.2 Create drag-and-drop list using @dnd-kit
  - [ ] 2.3 Add PATCH `/api/menu-items/reorder` endpoint
  - [ ] 2.4 Persist sort order changes to database
  - [ ] 2.5 Write tests for reordering functionality

- [ ] **Task 3: Dark mode for Kitchen Display** (AC: 6)
  - [ ] 3.1 Create `useDarkMode` hook with localStorage persistence
  - [ ] 3.2 Add dark mode CSS variables and Tailwind dark classes
  - [ ] 3.3 Add dark mode toggle button to Kitchen header
  - [ ] 3.4 Style all Kitchen components for dark mode
  - [ ] 3.5 Test contrast ratios meet WCAG AA standards
  - [ ] 3.6 Write tests for dark mode toggle

- [ ] **Task 4: Bulk order status updates** (AC: 7)
  - [ ] 4.1 Add checkbox selection to KitchenOrderCard
  - [ ] 4.2 Create bulk action toolbar (appears when items selected)
  - [ ] 4.3 Implement "Move All to [Status]" button
  - [ ] 4.4 Create bulk status update API endpoint
  - [ ] 4.5 Broadcast individual events for each order (maintain real-time consistency)
  - [ ] 4.6 Write tests for bulk selection and update

- [ ] **Task 5: Mobile responsiveness improvements** (AC: 8)
  - [ ] 5.1 Audit current responsive breakpoints
  - [ ] 5.2 Improve order entry form layout for tablets (768px-1024px)
  - [ ] 5.3 Add touch-friendly button sizes (min 44x44px)
  - [ ] 5.4 Improve menu browser grid for tablet landscape
  - [ ] 5.5 Test on actual tablet devices or emulator

## Dev Notes

### Architecture References

**Drag and Drop Library:**
- @dnd-kit 6.0+ already in tech stack
- Used previously for Kitchen board status columns

[Source: docs/architecture.md#Tech Stack]

**Component Locations:**
- Kitchen pages: `packages/web/src/pages/kitchen/`
- Admin pages: `packages/web/src/pages/admin/`
- Hooks: `packages/web/src/hooks/`

[Source: docs/architecture.md#Project Structure]

**Database Schema:**
- MenuItem model needs `sortOrder Int @default(0)` field
- Requires Prisma migration

[Source: docs/architecture.md#Prisma Schema]

**Tailwind CSS:**
- Use `dark:` prefix for dark mode classes
- Configure `darkMode: 'class'` in tailwind.config.js

[Source: docs/architecture.md#Tech Stack]

### Testing Requirements

**Test File Locations:**
- `packages/web/tests/hooks/` for new hooks
- `packages/web/tests/pages/kitchen/` for Kitchen tests
- `packages/api/tests/` for API tests

**Testing Frameworks:**
- Vitest + React Testing Library
- userEvent for keyboard testing
- @dnd-kit provides test utilities

[Source: docs/architecture.md#Tech Stack]

## Out of Scope

- Full offline support
- Custom keyboard shortcut configuration
- Themes beyond light/dark

## Estimated Effort

**Story Points:** 8

## Definition of Done

- [ ] All 8 acceptance criteria verified
- [ ] Keyboard shortcuts documented in help modal
- [ ] Dark mode meets WCAG AA contrast
- [ ] Mobile tested on tablet resolution
- [ ] All tests pass

---

## Change Log

| Date       | Version | Description         | Author            |
|------------|---------|---------------------|-------------------|
| 2026-01-15 | 0.1     | Initial story draft | Bob (Scrum Master)|
