# Story 4.4: Accessibility Improvements

## Status: Draft

## Story

**As a** user with accessibility needs,  
**I want** the application to be fully accessible,  
**so that** I can use all features regardless of ability.

## Acceptance Criteria

1. Screen reader announcements for real-time order status changes
2. ARIA live regions properly implemented for dynamic content
3. High contrast mode toggle available in all interfaces
4. Focus management correct when modals open/close
5. All interactive elements keyboard accessible
6. Color contrast meets WCAG 2.1 AA standards (4.5:1 minimum)
7. Skip links provided for main content areas
8. Form error messages properly associated with inputs

## Tasks / Subtasks

- [ ] **Task 1: Screen reader announcements for real-time updates** (AC: 1, 2)
  - [ ] 1.1 Create `AriaLiveRegion` component for announcements
  - [ ] 1.2 Add announcements for new order creation
  - [ ] 1.3 Add announcements for order status changes
  - [ ] 1.4 Add announcements for order completion notifications
  - [ ] 1.5 Configure politeness levels (polite vs assertive)
  - [ ] 1.6 Test with NVDA/VoiceOver screen readers
  - [ ] 1.7 Write tests for aria-live content updates

- [ ] **Task 2: High contrast mode** (AC: 3)
  - [ ] 2.1 Create `useHighContrast` hook with localStorage persistence
  - [ ] 2.2 Define high-contrast color palette
  - [ ] 2.3 Add high-contrast CSS variables
  - [ ] 2.4 Add toggle to all interface headers
  - [ ] 2.5 Ensure all text meets 7:1 contrast in high contrast mode
  - [ ] 2.6 Test with Windows High Contrast mode

- [ ] **Task 3: Focus management** (AC: 4, 5)
  - [ ] 3.1 Create `useFocusTrap` hook for modals
  - [ ] 3.2 Return focus to trigger element when modal closes
  - [ ] 3.3 Ensure all dropdowns, menus keyboard navigable
  - [ ] 3.4 Add visible focus indicators (2px outline minimum)
  - [ ] 3.5 Audit tab order across all pages
  - [ ] 3.6 Write tests for focus management

- [ ] **Task 4: Color contrast audit and fixes** (AC: 6)
  - [ ] 4.1 Audit all color combinations with contrast checker
  - [ ] 4.2 Fix any combinations below 4.5:1 ratio
  - [ ] 4.3 Ensure status badges meet contrast requirements
  - [ ] 4.4 Ensure button text meets contrast in all states
  - [ ] 4.5 Document approved color palette with ratios

- [ ] **Task 5: Skip links and landmarks** (AC: 7)
  - [ ] 5.1 Add skip to main content link at page top
  - [ ] 5.2 Add skip to navigation link
  - [ ] 5.3 Ensure proper landmark roles (main, nav, aside)
  - [ ] 5.4 Test skip link functionality

- [ ] **Task 6: Form accessibility** (AC: 8)
  - [ ] 6.1 Audit all forms for proper label associations
  - [ ] 6.2 Add aria-describedby for error messages
  - [ ] 6.3 Add aria-invalid for fields with errors
  - [ ] 6.4 Ensure required fields have aria-required
  - [ ] 6.5 Test form navigation with screen reader

## Dev Notes

### Architecture References

**Component Locations:**
- UI components: `packages/web/src/components/ui/`
- Forms: Various pages in `packages/web/src/pages/`
- Modals: `packages/web/src/components/ui/Modal.tsx` (if exists)

[Source: docs/architecture.md#Project Structure]

**Existing Accessibility:**
- Basic aria-labels on some components
- Tailwind has focus-visible utilities
- prefers-reduced-motion already implemented

[Source: Previous story implementations]

**WCAG 2.1 Requirements:**
- AA compliance minimum
- 4.5:1 contrast for normal text
- 3:1 contrast for large text (18px+ or 14px+ bold)
- 7:1 for AAA (high contrast mode)

### Testing Requirements

**Accessibility Testing:**
- Use axe-core for automated testing
- Manual testing with NVDA (Windows) or VoiceOver (Mac)
- Keyboard-only navigation testing

**Test Utilities:**
```typescript
import { axe, toHaveNoViolations } from 'jest-axe';
expect.extend(toHaveNoViolations);
```

**Test Location:**
- `packages/web/tests/` - add a11y test files
- Consider `*.a11y.test.tsx` naming convention

[Source: docs/architecture.md#Tech Stack]

## Out of Scope

- Multi-language support (internationalization)
- Voice control
- AAA compliance (except high contrast mode)

## Estimated Effort

**Story Points:** 8

## Definition of Done

- [ ] All 8 acceptance criteria verified
- [ ] axe-core audit passes with no violations
- [ ] Tested with screen reader (NVDA or VoiceOver)
- [ ] Keyboard-only navigation verified
- [ ] High contrast mode functional

---

## Change Log

| Date       | Version | Description         | Author            |
|------------|---------|---------------------|-------------------|
| 2026-01-15 | 0.1     | Initial story draft | Bob (Scrum Master)|
