# Story 4.6: Developer Experience

## Status: Draft

## Story

**As a** Developer,  
**I want** comprehensive documentation and development tools,  
**so that** I can understand the codebase and develop efficiently.

## Acceptance Criteria

1. Storybook configured with all reusable UI components documented
2. OpenAPI/Swagger documentation available at `/api/docs`
3. Component props documented with TypeScript JSDoc comments
4. Development environment setup automated with single command
5. Hot module replacement (HMR) working for all packages
6. Git hooks configured for pre-commit linting and testing
7. README updated with architecture overview and quick start guide

## Tasks / Subtasks

- [ ] **Task 1: Storybook setup and component documentation** (AC: 1, 3)
  - [ ] 1.1 Install and configure Storybook for React/Vite
  - [ ] 1.2 Create stories for Button, Input, Select base components
  - [ ] 1.3 Create stories for OrderCard component
  - [ ] 1.4 Create stories for KitchenOrderCard component
  - [ ] 1.5 Create stories for MenuItemCard component
  - [ ] 1.6 Create stories for OrderStatusBadge component
  - [ ] 1.7 Add controls/args for interactive component playground
  - [ ] 1.8 Configure Storybook autodocs from TSDoc comments
  - [ ] 1.9 Add Storybook build to CI

- [ ] **Task 2: API documentation with Swagger** (AC: 2)
  - [ ] 2.1 Install swagger-ui-express and swagger-jsdoc
  - [ ] 2.2 Add JSDoc comments to all API routes
  - [ ] 2.3 Configure swagger-jsdoc to generate spec
  - [ ] 2.4 Mount Swagger UI at `/api/docs`
  - [ ] 2.5 Document request/response schemas
  - [ ] 2.6 Document authentication (if applicable)
  - [ ] 2.7 Add WebSocket event documentation section

- [ ] **Task 3: Development environment automation** (AC: 4, 5)
  - [ ] 3.1 Create `scripts/setup.sh` (and `.ps1` for Windows)
  - [ ] 3.2 Automate: install dependencies, copy .env.example, run migrations
  - [ ] 3.3 Verify HMR working in web package
  - [ ] 3.4 Configure nodemon for API hot reload
  - [ ] 3.5 Add `pnpm dev` command that starts all services
  - [ ] 3.6 Document environment variables in .env.example

- [ ] **Task 4: Git hooks with Husky** (AC: 6)
  - [ ] 4.1 Install and configure Husky
  - [ ] 4.2 Add pre-commit hook: lint-staged for ESLint
  - [ ] 4.3 Add pre-commit hook: TypeScript type check
  - [ ] 4.4 Add pre-push hook: run tests (optional, can be slow)
  - [ ] 4.5 Configure lint-staged to only check changed files
  - [ ] 4.6 Document how to skip hooks when needed

- [ ] **Task 5: README and documentation updates** (AC: 7)
  - [ ] 5.1 Add architecture diagram to README
  - [ ] 5.2 Add quick start guide (5-minute setup)
  - [ ] 5.3 Document available npm scripts
  - [ ] 5.4 Add troubleshooting section
  - [ ] 5.5 Add contributing guidelines
  - [ ] 5.6 Add links to Storybook and API docs

## Dev Notes

### Architecture References

**Project Structure:**
- Components: `packages/web/src/components/`
- API routes: `packages/api/src/routes/`
- Shared types: `packages/shared/src/types/`

[Source: docs/architecture.md#Project Structure]

**Tech Stack:**
- Vite 5.0+ (already has HMR)
- Express 4.18+ 
- TypeScript 5.3+

[Source: docs/architecture.md#Tech Stack]

**Storybook Configuration:**
```javascript
// .storybook/main.ts
export default {
  stories: ['../packages/web/src/**/*.stories.@(ts|tsx)'],
  framework: '@storybook/react-vite',
  addons: ['@storybook/addon-essentials'],
};
```

**Swagger Configuration:**
```typescript
// swagger.config.ts
const swaggerSpec = swaggerJsdoc({
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'RestaurantFlow API',
      version: '1.0.0',
    },
  },
  apis: ['./src/routes/*.ts'],
});
```

### Component Documentation Pattern

```typescript
/**
 * OrderCard displays a summary of an order for the staff view.
 * 
 * @example
 * <OrderCard order={order} isNew={true} />
 */
interface OrderCardProps {
  /** The order object to display */
  order: Order;
  /** Whether this is a newly created order (shows animation) */
  isNew?: boolean;
  /** Whether this order was recently updated (shows animation) */
  isUpdated?: boolean;
}
```

### Testing Requirements

**Storybook Testing:**
- Install @storybook/test-runner for automated story tests
- Add to CI pipeline

**Test Location:**
- Story files: `*.stories.tsx` next to components
- Or centralized in `.storybook/stories/`

[Source: docs/architecture.md#Project Structure]

## Out of Scope

- Storybook deployment to public URL
- API versioning
- Changelog automation

## Estimated Effort

**Story Points:** 5

## Definition of Done

- [ ] All 7 acceptance criteria verified
- [ ] Storybook builds and runs
- [ ] Swagger UI accessible at /api/docs
- [ ] New developer can set up in <10 minutes
- [ ] Git hooks working

---

## Change Log

| Date       | Version | Description         | Author            |
|------------|---------|---------------------|-------------------|
| 2026-01-15 | 0.1     | Initial story draft | Bob (Scrum Master)|
